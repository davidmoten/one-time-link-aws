<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1085px" preserveAspectRatio="none" style="width:990px;height:1085px;background:#FFFFFF;" version="1.1" viewBox="0 0 990 1085" width="990px" zoomAndPan="magnify"><defs><filter height="300%" id="f1jcuk1vf5ab8s" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1jcuk1vf5ab8s)" height="439.2578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="638" y="401.0234"/><rect fill="#FFFFFF" filter="url(#f1jcuk1vf5ab8s)" height="277.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="692" y="445.2891"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="88.2969" y2="1001.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="90" x2="90" y1="88.2969" y2="1001.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="402.5" x2="402.5" y1="88.2969" y2="1001.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="643" x2="643" y1="88.2969" y2="1001.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="696.5" x2="696.5" y1="88.2969" y2="1001.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="772.5" x2="772.5" y1="88.2969" y2="1001.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="865" x2="865" y1="88.2969" y2="1001.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="84.9951">User</text><ellipse cx="23.5" cy="15" fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,23 L23.5,50 M10.5,31 L36.5,31 M23.5,50 L10.5,65 M23.5,50 L36.5,65 " fill="none" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="1013.0732">User</text><ellipse cx="23.5" cy="1026.375" fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,1034.375 L23.5,1061.375 M10.5,1042.375 L36.5,1042.375 M23.5,1061.375 L10.5,1076.375 M23.5,1061.375 L36.5,1076.375 " fill="none" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="52" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="59" y="72.9951">Browser</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="72" x="52" y="1000.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="58" x="59" y="1020.0732">Browser</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="37" x="382.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23" x="389.5" y="72.9951">API</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="37" x="382.5" y="1000.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23" x="389.5" y="1020.0732">API</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="32" x="625" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="18" x="632" y="72.9951">S3</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="32" x="625" y="1000.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="18" x="632" y="1020.0732">S3</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="673.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="680.5" y="72.9951">SQS</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="43" x="673.5" y="1000.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="680.5" y="1020.0732">SQS</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="80" x="730.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="737.5" y="72.9951">Browser2</text><rect fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="80" x="730.5" y="1000.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="737.5" y="1020.0732">Browser2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="831" y="84.9951">Receiver</text><ellipse cx="865.5" cy="15" fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M865.5,23 L865.5,50 M852.5,31 L878.5,31 M865.5,50 L852.5,65 M865.5,50 L878.5,65 " fill="none" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="831" y="1013.0732">Receiver</text><ellipse cx="865.5" cy="1026.375" fill="#FEFECE" filter="url(#f1jcuk1vf5ab8s)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M865.5,1034.375 L865.5,1061.375 M852.5,1042.375 L878.5,1042.375 M865.5,1061.375 L852.5,1076.375 M865.5,1061.375 L878.5,1076.375 " fill="none" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FFFFFF" filter="url(#f1jcuk1vf5ab8s)" height="439.2578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="638" y="401.0234"/><rect fill="#FFFFFF" filter="url(#f1jcuk1vf5ab8s)" height="277.3281" style="stroke:#A80036;stroke-width:1.0;" width="10" x="692" y="445.2891"/><polygon fill="#A80036" points="78,115.4297,88,119.4297,78,123.4297,82,119.4297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="84" y1="119.4297" y2="119.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="30.5" y="114.3638">Secret</text><line style="stroke:#A80036;stroke-width:1.0;" x1="90" x2="132" y1="154.6289" y2="154.6289"/><line style="stroke:#A80036;stroke-width:1.0;" x1="132" x2="132" y1="154.6289" y2="167.6289"/><line style="stroke:#A80036;stroke-width:1.0;" x1="91" x2="132" y1="167.6289" y2="167.6289"/><polygon fill="#A80036" points="101,163.6289,91,167.6289,101,171.6289,97,167.6289" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="97" y="149.563">SecretId</text><path d="M161,132.4297 L161,172.4297 L313,172.4297 L313,142.4297 L303,132.4297 L161,132.4297 " fill="#FBFB77" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M303,132.4297 L303,142.4297 L313,142.4297 L303,132.4297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="167" y="149.4966">16 chars</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="167" y="164.6294">randomly generated</text><line style="stroke:#A80036;stroke-width:1.0;" x1="90" x2="132" y1="208.8945" y2="208.8945"/><line style="stroke:#A80036;stroke-width:1.0;" x1="132" x2="132" y1="208.8945" y2="221.8945"/><line style="stroke:#A80036;stroke-width:1.0;" x1="91" x2="132" y1="221.8945" y2="221.8945"/><polygon fill="#A80036" points="101,217.8945,91,221.8945,101,225.8945,97,221.8945" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="97" y="203.8286">Password</text><path d="M171,186.6953 L171,226.6953 L323,226.6953 L323,196.6953 L313,186.6953 L171,186.6953 " fill="#FBFB77" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M313,186.6953 L313,196.6953 L323,196.6953 L313,186.6953 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="177" y="203.7622">16 chars</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="177" y="218.895">randomly generated</text><line style="stroke:#A80036;stroke-width:1.0;" x1="90" x2="132" y1="278.293" y2="278.293"/><line style="stroke:#A80036;stroke-width:1.0;" x1="132" x2="132" y1="278.293" y2="291.293"/><line style="stroke:#A80036;stroke-width:1.0;" x1="91" x2="132" y1="291.293" y2="291.293"/><polygon fill="#A80036" points="101,287.293,91,291.293,101,295.293,97,291.293" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="97" y="273.2271">EncryptedSecret</text><path d="M215,240.9609 L215,310.9609 L392,310.9609 L392,250.9609 L382,240.9609 L215,240.9609 " fill="#FBFB77" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M382,240.9609 L382,250.9609 L392,250.9609 L382,240.9609 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="221" y="258.0278">Secret is encrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="221" y="273.1606">using AES 256</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="221" y="288.2935">with key Password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="221" y="303.4263">then encoded to Base64</text><polygon fill="#A80036" points="391,337.625,401,341.625,391,345.625,395,341.625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="90" x2="397" y1="341.625" y2="341.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="97" y="336.5591">store(SecretId, EncryptedSecret, ExpiryTime)</text><polygon fill="#A80036" points="626,397.0234,636,401.0234,626,405.0234,630,401.0234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="632" y1="401.0234" y2="401.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="410" y="365.6919">Put object of name</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="410" y="380.8247">SecretId, value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="410" y="395.9575">EncryptedSecret</text><polygon fill="#A80036" points="680,441.2891,690,445.2891,680,449.2891,684,445.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="686" y1="445.2891" y2="445.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="410" y="425.0903">create queue of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="410" y="440.2231">name SecretId.fifo</text><polygon fill="#A80036" points="680,485.5547,690,489.5547,680,493.5547,684,489.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="686" y1="489.5547" y2="489.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="410" y="469.356">send message with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="410" y="484.4888">ExpiryTime to queue</text><polygon fill="#A80036" points="101,514.6875,91,518.6875,101,522.6875,97,518.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="95" x2="402" y1="518.6875" y2="518.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="107" y="513.6216">url (Password + SecretId)</text><polygon fill="#A80036" points="34.5,543.8203,24.5,547.8203,34.5,551.8203,30.5,547.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="89" y1="547.8203" y2="547.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="40.5" y="542.7544">url</text><polygon fill="#A80036" points="853.5,572.9531,863.5,576.9531,853.5,580.9531,857.5,576.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="859.5" y1="576.9531" y2="576.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="30.5" y="571.8872">url</text><polygon fill="#A80036" points="783.5,602.0859,773.5,606.0859,783.5,610.0859,779.5,606.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="777.5" x2="864.5" y1="606.0859" y2="606.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="789.5" y="601.02">decrypt url</text><polygon fill="#A80036" points="414,631.2188,404,635.2188,414,639.2188,410,635.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408" x2="771.5" y1="635.2188" y2="635.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="420" y="630.1528">decrypt (SecretId, EncryptedSecret)</text><polygon fill="#A80036" points="680,660.3516,690,664.3516,680,668.3516,684,664.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="686" y1="664.3516" y2="664.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="410" y="659.2856">read ExpiryTime from queue SecretId.fifo</text><polygon fill="#A80036" points="414,689.4844,404,693.4844,414,697.4844,410,693.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408" x2="691" y1="693.4844" y2="693.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="420" y="688.4185">ExpiryTime</text><polygon fill="#A80036" points="685,718.6172,695,722.6172,685,726.6172,689,722.6172" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="691" y1="722.6172" y2="722.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="410" y="717.5513">delete queue SecretId.fifo</text><polygon fill="#A80036" points="626,778.0156,636,782.0156,626,786.0156,630,782.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="632" y1="782.0156" y2="782.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="410" y="746.6841">get EncryptedSecret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="410" y="761.8169">from S3 bucket with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="410" y="776.9497">object name SecretId</text><path d="M653,745.75 L653,770.75 L880,770.75 L880,755.75 L870,745.75 L653,745.75 " fill="#FBFB77" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M870,745.75 L870,755.75 L880,755.75 L870,745.75 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="659" y="762.8169">only if now is before ExpiryTime</text><polygon fill="#A80036" points="414,807.1484,404,811.1484,414,815.1484,410,811.1484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408" x2="637" y1="811.1484" y2="811.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="420" y="806.0825">EncryptedSecret</text><polygon fill="#A80036" points="631,836.2813,641,840.2813,631,844.2813,635,840.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="637" y1="840.2813" y2="840.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="410" y="835.2153">delete object with name SecretId</text><polygon fill="#A80036" points="760.5,865.4141,770.5,869.4141,760.5,873.4141,764.5,869.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403" x2="766.5" y1="869.4141" y2="869.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="410" y="864.3481">EncryptedSecret</text><line style="stroke:#A80036;stroke-width:1.0;" x1="772.5" x2="814.5" y1="919.7461" y2="919.7461"/><line style="stroke:#A80036;stroke-width:1.0;" x1="814.5" x2="814.5" y1="919.7461" y2="932.7461"/><line style="stroke:#A80036;stroke-width:1.0;" x1="773.5" x2="814.5" y1="932.7461" y2="932.7461"/><polygon fill="#A80036" points="783.5,928.7461,773.5,932.7461,783.5,936.7461,779.5,932.7461" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="779.5" y="914.6802">decrypt</text><path d="M840,882.4141 L840,952.4141 L981,952.4141 L981,892.4141 L971,882.4141 L840,882.4141 " fill="#FBFB77" filter="url(#f1jcuk1vf5ab8s)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M971,882.4141 L971,892.4141 L981,892.4141 L971,882.4141 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="846" y="899.481">EncryptedSecret is</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="846" y="914.6138">Base64 decoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="846" y="929.7466">and decrypted</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="846" y="944.8794">using SecretId</text><polygon fill="#A80036" points="853.5,979.0781,863.5,983.0781,853.5,987.0781,857.5,983.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="772.5" x2="859.5" y1="983.0781" y2="983.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="779.5" y="978.0122">Secret</text><!--MD5=[32f0d5af7b8e98af43282acba226543f]
@startuml
actor User
participant Browser
participant API
participant S3
participant SQS
participant Browser2
actor Receiver
User-> Browser: Secret
Browser-> Browser: SecretId
note right: 16 chars\nrandomly generated
Browser-> Browser: Password
note right: 16 chars\nrandomly generated
Browser-> Browser: EncryptedSecret
note right: Secret is encrypted \nusing AES 256\nwith key Password\nthen encoded to Base64
Browser-> API: store(SecretId, EncryptedSecret, ExpiryTime)
API->S3:Put object of name \nSecretId, value \nEncryptedSecret
activate S3
API->SQS: create queue of \nname SecretId.fifo
activate SQS
API->SQS: send message with\nExpiryTime to queue
API->Browser: url (Password + SecretId)
Browser->User: url
User->Receiver: url
Receiver -> Browser2: decrypt url
Browser2 -> API: decrypt (SecretId, EncryptedSecret)
API->SQS: read ExpiryTime from queue SecretId.fifo
SQS->API: ExpiryTime
API->SQS: delete queue SecretId.fifo
deactivate SQS
API->S3: get EncryptedSecret\nfrom S3 bucket with\nobject name SecretId
note right: only if now is before ExpiryTime
S3->API: EncryptedSecret
API->S3:delete object with name SecretId
deactivate S3
API->Browser2: EncryptedSecret
Browser2->Browser2:decrypt
note right:EncryptedSecret is\nBase64 decoded\nand decrypted\nusing SecretId
Browser2->Receiver: Secret
@enduml

PlantUML version 1.2021.7(Sun May 23 12:40:07 UTC 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>