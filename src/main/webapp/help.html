<html>
<h2>About <b>One Time Link</b></h2>

<p>If you have a secret (text) that you want to communicate to someone then 
submit your text to One Time Link and it will give you a link that you can give
to that person for them to view the secret. 
</p>
<ul>
<li>The link will display the secret once and only once.</li>
<li>The secret is encrypted using a key that is present in
the generated link. Only the encrypted secret is present in backend
storage and the backend is not aware of the key used to encrypt the secret.</li>
<li>The encrypted secret is deleted from backend storage on viewing</li>
<li>Unviewed encrypted secrets are deleted from backend storage within 12 hours of expiry</li>
</ul>

<p>Make sure you communicate that link to someone via a <b>secure means</b> (like Signal, WhatsApp). If 
you send the link to someone using a non-secure means like email 
then you are exposed to a man-in-the-middle attack in that someone else can intercept the 
link, view it, then create another link to forward to the receiving party. Neither the sender nor the receiving 
part are aware of the leaking of the secret.</p>

 
<h3>Instructions</h3>
<ul>
<li>Paste your secret into the given textbox</li>
<li>Select how long the link will remain valid for</li>
<li>Click Encrypt</li>
<li>Copy the link and send it to the receiver via a secure means</li>
</ul>
<p>

<h3>Implementation</h3>
<p>Version: ${project.version}</p>
<p>When you click on the Encrypt button the following happens:</p>

<img src="sequence-diagram.svg"/>

<pre>
@startuml
actor User
participant Browser
participant API
participant S3
participant SQS
participant Browser2
actor Receiver
User-> Browser: Secret
Browser-> Browser: SecretId
note right: 16 chars\nrandomly generated
Browser-> Browser: Password
note right: 16 chars\nrandomly generated
Browser-> Browser: EncryptedSecret
note right: Secret is encrypted \nusing AES 256\nwith key Password\nthen encoded to Base64
Browser-> API: store(SecretId, EncryptedSecret, ExpiryTime)
API->S3:Put object of name \nSecretId, value \nEncryptedSecret
activate S3
API->SQS: create queue of \nname SecretId.fifo
activate SQS
API->SQS: send message with\nExpiryTime to queue
API->Browser: url (Password + SecretId)
Browser->User: url
User->Receiver: url
Receiver -> Browser2: decrypt url
Browser2 -> API: decrypt (SecretId, EncryptedSecret)
API->SQS: read time from queue SecretId.fifo
SQS->API: time
API->SQS: delete queue SecretId.fifo
deactivate SQS
API->S3: get EncryptedSecret\nfrom S3 bucket with\nobject name SecretId
S3->API: EncryptedSecret
API->S3:delete object with name SecretId
deactivate S3
note right: only if currentTime\nless than time
API->Browser2: EncryptedSecret
Browser2->Browser2:decrypt
note right:EncryptedSecret is\nBase64 decoded\nand decrypted\nusing SecretId
Browser2->Receiver: Secret
@enduml
</pre>


</html>